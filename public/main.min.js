(()=>{var __webpack_modules__={548:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var i=n(258);const s={modules(){for(let[t,e]of i.Z.getModules())i.Z.print(t)},async install([t]){if(t){const e=await i.Z.fetchModule(t).catch((t=>{i.Z.print("[Error] "+t.message)}));await i.Z.installModule(e)}else i.Z.print("Provide a module path.")},async uninstall([t]){t&&""!=t?await i.Z.uninstallModule(t):i.Z.print("Provide a module name.")},clear(t){i.Z.getTerminal().clear()},help(){i.Z.print(`\nCommands: \n${Object.keys(this).join(", ")}\n`)},exit:t=>new Promise((t=>{const e=i.Z.getTerminal();e.setPrefix(""),e.disableInput(),e.clear(),i.Z.print("Bye."),setTimeout((()=>window.close()),1e3)}))}},258:(t,e,n)=>{"use strict";n.d(e,{Z:()=>T});var i=n(548);const s=[32,32],o=[1,0],a="#eee",r=" ~{}@=<>^abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ()[]-.,_:;#+'*/&%$§!?€1234567890\"";let l,c,_=!0,u=7.69,d=["Terminal Version 1.0","(c) 2020 luckydye. All rights reserved.",""],h=[],p=[d[d.length-1].length,d.length-1],m=[0,0],f=[[0,0],[0,0]],w="",g=!0,E=!1,M=localStorage.history?JSON.parse(localStorage.history):[],P=-1;class y extends Event{constructor(t){super("submit"),this.value=t}}class C extends Event{get defaultPrevented(){return this._defaultPrevented}set defaultPrevented(t){this._defaultPrevented=t}constructor(t){super("shortcut"),this.key=t,this._defaultPrevented=!1}}class v extends HTMLElement{get hideOutput(){return E}set hideOutput(t){E=t}get inputEnabled(){return g}set inputEnabled(t){g=t}get prefix(){return w}set prefix(t){w=t}get cursor(){return p}constructor(){super(),l=document.createElement("canvas"),l.tabIndex=0,c=l.getContext("2d"),window.addEventListener("resize",(t=>{this.reformat()})),window.addEventListener("wheel",(t=>{const e=Math.sign(t.deltaY),n=this.getCursorPosition()[1],i=Math.max(0,n-(l.height-3*this.lineHeight));m[1]=Math.max(0,Math.min(i,m[1]+e*this.lineHeight))})),window.addEventListener("keydown",(t=>{this.handleInput(t)}));let t=[0,0];const e=(t,e,n)=>{const i=this.pixelToBufferPos(e+m[0],n+m[1]);f[t][0]=i[0],f[t][1]=i[1]},n=n=>{let i=1;t[1]>n.clientY&&(i=0),e(i,n.clientX,n.clientY)};window.addEventListener("mousedown",(i=>{0===i.button&&(t[0]=i.clientX,t[1]=i.clientY,e(0,i.clientX,i.clientY),e(1,i.clientX,i.clientY),window.addEventListener("mousemove",n))})),window.addEventListener("mouseup",(i=>{if(0===i.button){let s=1;t[1]>i.clientY&&(s=0),e(s,i.clientX,i.clientY),window.removeEventListener("mousemove",n)}})),this.addEventListener("contextmenu",(t=>{const e=this.getSelectionFromBuffer(f);navigator.clipboard.writeText(e),this.resetSelection(),t.preventDefault()})),this.attachShadow({mode:"open"})}resetSelection(){f=[[0,0],[0,0]]}getSelectionFromBuffer(t){let e=[];const n=t[0][1],i=t[1][1]-t[0][1],s=t[0],o=t[1];for(let t=0;t<=i;t++){let a=t>0&&i>0?0:s[0],r=t===i?o[0]:void 0;const l=d[n+t].slice(a,r);e.push(l)}return e.join("\n")}pixelToBufferPos(t,e){return[Math.floor((t-s[0])/u),Math.floor((e-s[1])/this.lineHeight)]}getContext(){return c}init(){const t=document.createElement("style");t.innerHTML="\n            :host {\n                display: block;\n                width: 100%;\n                height: 100%;\n            }\n            canvas {\n                filter: contrast(1.1) blur(.33px);\n                outline: none;\n            }\n        ",this.shadowRoot.appendChild(t),this.shadowRoot.appendChild(l),this.loop()}connectedCallback(){l.parentNode||this.init(),this.reformat()}append(t,e){const n=d.slice(0,t);n.push(e),n.push(...d.slice(t)),p[1]>=t&&p[1]++,this.setBuffer(n)}setBuffer(t){d=t}clear(){d=[""],this.setCursor(0,0)}setCursor(t,e){p[0]=null!=t?t:p[0],p[1]=null!=e?e:p[1]}setPrefix(t=""){this.prefix=t}disableInput(){this.inputEnabled=!1}enableInput(){this.inputEnabled=!0}disableLineWrapping(){_=!1}enableLineWrapping(){_=!0}handleSubmit(t){E?(t=h.join(""),E=!1):t=t.slice(this.prefix.length),this.pushToHistory(t),this.dispatchEvent(new y(t))}pushToHistory(t){t!=M[0]&&(""!=t&&M.unshift(t),P=-1,localStorage.history=JSON.stringify(M))}cancelInput(){d[p[1]]=this.prefix,this.setCursor(d[p[1]].length)}replaceInput(t){this.cancelInput(),this.write(t)}read(t){return new Promise((e=>{const n=d[d.length-1];this.inputEnabled=!0,this.prefix=t||n,t&&n!==t&&this.write(t);const i=t=>{e(t.value),this.removeEventListener("submit",i)};this.addEventListener("submit",i)}))}newline(){const t=d[d.length-1];return d.push(""),p[0]="".length,p[1]++,t}write(t){switch(t){case"\0":break;case"\r":const e=this.newline();this.handleSubmit(e);break;case"\n":this.newline();break;default:const n=d[p[1]].split("").slice(0,p[0]);E?(h.push(t),n.push(...new Array(t.length).fill("*"))):n.push(t);const i=d[p[1]].split("").slice(p[0]);n.push(...i),d[p[1]]=n.join(""),p[0]+=t.length}const e=this.getCursorPosition()[1];m[1]=Math.max(0,e-(l.height-3*this.lineHeight))}handleInput(t){let e=t.key;t.shiftKey;const n=t.ctrlKey;if(g){if("Enter"==e&&this.write("\r"),"ArrowUp"==e&&(P=Math.min(P+1,M.length-1),M[P]&&this.replaceInput(M[P])),"ArrowDown"==e&&(P=Math.max(P-1,0),M[P]&&this.replaceInput(M[P])),"ArrowLeft"==e&&(p[0]=Math.max(p[0]-1,Math.max(w.length,0))),"ArrowRight"==e&&(p[0]=Math.min(p[0]+1,d[d.length-1].length)),"Escape"==e&&this.cancelInput(),"End"==e&&(p[0]=d[d.length-1].length),"Home"==e&&(p[0]=Math.max(w.length,0)),"Backspace"==e&&p[0]>0&&p[0]>w.length){const t=d[d.length-1].split("").slice(0,p[0]-1),e=d[d.length-1].split("").slice(p[0]);t.push(...e),d[d.length-1]=t.join(""),p[0]--}if("Delete"==e){const t=d[d.length-1].split("").slice(0,p[0]),e=d[d.length-1].split("").slice(p[0]+1);t.push(...e),d[d.length-1]=t.join("")}-1==r.indexOf(e)||n||this.write(e)}if(n){const n=new C(e);this.dispatchEvent(n),t.preventDefault(),t.stopPropagation(),n.defaultPrevented||-1!=r.indexOf(e)&&this.dispatchEvent(new y("^"+e))}}reformat(){l.width=this.clientWidth,l.height=this.clientHeight;const t=this.getCursorPosition()[1];m[1]=Math.max(0,t-(l.height-3*this.lineHeight))}draw(t){t.clearRect(0,0,t.canvas.width,t.canvas.height),t.font="200 13px monospace",t.textAlign="left",t.textBaseline="top";const e=t.measureText("M");u=e.width,t.shadowColor=a,t.shadowBlur=0,t.fillStyle=a,this.drawBuffer(),this.inputEnabled&&this.drawCursor(),this.drawSelection(),t.shadowColor="none",t.shadowBlur=0}drawCursor(){if(Date.now()/500%2>1){const t=this.getCursorPosition();c.fillStyle=a,c.fillRect(t[0],t[1]-m[1],6,16)}}bufferToPixelPos(t,e){return[t*u+s[0]-m[0],e*this.lineHeight+s[1]-m[1]]}drawSelection(){const t=this.bufferToPixelPos(...f[0]),e=this.bufferToPixelPos(...f[1]);c.globalCompositeOperation="screen",c.shadowColor="",c.shadowBlur=0;const n=f[1][1]-f[0][1];for(let i=0;i<=n;i++){let s=0;const o=t[1]+this.lineHeight*i;let a=u;const r=e[0]-t[0];a=n===i?r+t[0]:l.width,0===i&&(s=t[0],n===i&&(a=r)),c.fillStyle="#717171",c.fillRect(s,o,a,this.lineHeight)}c.globalCompositeOperation=""}getMaxBufferWidth(){return l.width-2*s[0]}get lineHeight(){return 15}getCursorPosition(){const t=this.getMaxBufferWidth();let e=0;for(let n=0;n<p[1];n++){const i=d[n];if(t-c.measureText(i).width<0&&_){const n=O(i,t/u);for(let t of n)e++}else e++}return[s[0]+p[0]*u+o[0],s[1]+12*e+3*e+6-8+o[1]]}drawBuffer(){const t=this.getMaxBufferWidth();let e=s[0],n=s[1]-m[1];const i=t=>{c.fillText(t,e,n),n+=15};for(let e of d)if(t-c.measureText(e).width<0&&_){const n=O(e,t/u);for(let t of n)i(t)}else i(e)}loop(){this.draw(c),requestAnimationFrame(this.loop.bind(this))}}function O(t,e){const n=[];for(t=t.split("");t.length>e;){const i=t.splice(0,e);n.push(i.join(""))}return n.push(t.join("")),n}customElements.define("gyro-terminal",v);const b=new v;let x=new Map;const D="modules";function I(){let t=localStorage.getItem(D);return t||(t='{ "modules": [] }'),JSON.parse(t)}function L(t){localStorage.setItem(D,JSON.stringify(t))}class T{static async loadModules(){const t=I();for(let e of t.modules){const t=await T.fetchModule(e).catch((t=>{T.print("[Module Error] Module: '"+e+"': "+t.message)}));T.installModule(t)}}static getModules(){return x}static async fetchModule(t){const e=await fetch(t).then((t=>t.text())),n="data:application/javascript;base64,"+btoa(e),i=await fetchModule(n);i.origin=t;let s=I();return-1===s.modules.indexOf(i.origin)&&s.modules.push(i.origin),L(s),i}static async installModule(t){const e=t.moduleName||t.origin;if(x.get(e))T.print(`[Module] Module '${e}' already installed.`);else try{if(!t.install)throw new Error(`Missing install method in module: ${path}`);x.set(e,t),await t.install(T),T.print(`[Module] Installed module '${e}'`),t.commandName&&(i.Z[t.commandName]=t.run)}catch(t){T.print("[Error] "+t.message)}}static uninstallModule(t){const e=x.get(t);if(e){x.delete(t),e.uninstall(),e.commandName&&(i.Z[e.commandName]=null);let n=I();n.modules.splice(n.modules.indexOf(e.origin),1),L(n),T.print(`[Module] Uninstalled module '${t}'`)}else T.print("Module not found.")}static getTerminal(){return b}static async simulateWrite(t,e=24){return new Promise((n=>{b.disableInput();let i=0;const s=setInterval((()=>{const e=t[i];b.write(e),i++,i==t.length&&(clearInterval(s),n())}),e)}))}static print(t){"object"==typeof t&&(t=JSON.stringify(t,null,"\t"));const e=t.split("\n");for(let t of e)b.write(t),b.write("\n")}static sleep(t){return new Promise((e=>{setTimeout((()=>e()),t)}))}}},12:(t,e,n)=>{"use strict";window.ConsoleModule=class{static install(){}static uninstall(){}static run(t){}}},285:(t,e,n)=>{"use strict";let i;n.d(e,{Z:()=>s});class s extends ConsoleModule{static get moduleName(){return"dl-module"}static get commandName(){return"dl"}static install(t){i=t}static async run(t){const e=t[0];if(!e)return i.print("Provide a video link.");const n=await async function(t){const e=new URL(t);let n=e.host;switch(console.log(n),n){case"clips.twitch.tv":const t={query:`{\n                    clip(slug: "${e.pathname.split("/")[1]}") {\n                        broadcaster {\n                            displayName\n                        }\n                        createdAt\n                        curator {\n                            displayName\n                            id\n                        }\n                        durationSeconds\n                        id\n                        tiny: thumbnailURL(width: 86, height: 45)\n                        small: thumbnailURL(width: 260, height: 147)\n                        medium: thumbnailURL(width: 480, height: 272)\n                        title\n                        videoQualities {\n                            frameRate\n                            quality\n                            sourceURL\n                        }\n                        viewCount\n                    }\n                }`};return fetch("https://gql.twitch.tv/gql",{method:"POST",headers:{"Client-ID":"kimne78kx3ncx6brgo4mv6wki5h1ko"},body:JSON.stringify(t)}).then((t=>t.json())).then((t=>{const e=t.data.clip;return{service:n,source:e.videoQualities[0].sourceURL}}))}return null}(e);n?(function(t){if(t){const e=document.createElement("a");e.href=t,e.download=t,e.click()}}(n.source),i.print(n)):i.print("Not a valid video url.")}}},591:t=>{const e=localStorage.twitch_client_id,n=localStorage.twitch_client_secret;let i,s=null;function o(){return i.print("authorizing..."),fetch(`https://id.twitch.tv/oauth2/token?client_id=${e}&client_secret=${n}&grant_type=client_credentials&scope=`,{method:"POST"}).then((t=>t.json())).then((t=>s=t))}async function a(t,n={}){const i=Object.assign({headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.access_token}`,"Client-ID":e}},n);return await fetch(t,i).then((t=>t.json()))}async function r(t){return s||await o(),a(`https://api.twitch.tv/helix/users?login=${t}`).then((t=>{if(0==t.data.length)throw new Error("User not found");return t}))}async function l(t){const e=(await r(t)).data[0],n=[];return i.print(`Fethcing ${t} followers,`),await async function t(s){const o=await async function(t){let n=`https://api.twitch.tv/helix/users/follows?to_id=${e.id}&first=100`;return t&&(n+=`&after=${t}`),await a(n)}(s);i.print(`${n.length} / ${o.total}`),n.push(...o.data),o.pagination.cursor&&await t(o.pagination.cursor)}(),n}t.exports={setConsole:function(t){i=t},getUserByLogin:r,getUserFollowers:async function(t){const e=(await r(t)).data[0],n=[];await async function t(i){const s=await async function(t){let n=`https://api.twitch.tv/helix/users/follows?from_id=${e.id}&first=100`;return t&&(n+=`&after=${t}`),await a(n)}(i);n.push(...s.data),s.pagination.cursor&&await t(s.pagination.cursor)}(),i.print(`${e.display_name} is following (${n.length}):`);for(let t of n)i.print(`${t.followed_at}, ${t.to_name}`)},getChannelViewerOverlap:async function(t,e){i.print(`Getting channel follower overlap of ${t} and ${e}`);const n=await l(t),s=await l(e),o={};let a=0;for(let t of n)o[t.from_id]=0;for(let t of s)null!=o[t.from_id]&&(a++,o[t.from_id]=1),o[t.from_id]=0;return i.print(`${a} of ${t}(${n.length}) [${(a/n.length*100).toFixed(3)}%] are also in ${e}`),a/n.length*100},getStreamsByUser:async function(t){return s||await o(),a(`https://api.twitch.tv/helix/streams?user_login=${t}`).then((async t=>t.data[0]))},queryClipsByStreamId:async function(t){let e=0;for(;e<5910;){e++;const n=`https://clips-media-assets2.twitch.tv/${t}-offset-${e}.mp4`;await fetch(n).then((t=>{i.print(n,t.status)}))}return t},getVODsByUser:async function(t){return s||await o(),a(`https://api.twitch.tv/helix/videos?user_id=${(await r(t)).data[0].id}&type=archive&first=100`).then((async t=>t.data))},getChannelAllFollowers:async function(t){i.print("Getting channel followers...");const e=await l(t);for(let t of e)i.print(`${t.followed_at}, ${t.from_name}`)}}},245:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var i=n(591);const s={streamClips:async t=>t[0]?await(0,i.queryClipsByStreamId)(t[0]):"Provide twitch login name.",vod:async t=>t[0]?await(0,i.getVODsByUser)(t[0]):"Provide twitch login name.",stream:async t=>t[0]?await(0,i.getStreamsByUser)(t[0]):"Provide twitch login name.",user:async t=>t[0]?(await(0,i.getUserByLogin)(t[0])).data[0]:"Provide twitch login name.",following(t){if(!t[0])return"Provide twitch login name!";(0,i.getUserFollowers)(t[0])},followers(t){if(!t[0])return"Provide twitch login name!";(0,i.getChannelAllFollowers)(t[0])},viewership(t){if(!t[0]||!t[1])return"Provide twitch login name!";(0,i.getChannelViewerOverlap)(t[0],t[1])}};let o;class a extends ConsoleModule{static get moduleName(){return"twitch-module"}static get commandName(){return"twitch"}static install(t){o=t}static async run(t){(0,i.setConsole)(o);const e=t[0],n=t.slice(1);if(e in s){const t=await s[e](n);t&&o.print(t)}else o.print("Unknown command"),o.print(`Commands: ${Object.keys(s)}`)}}},685:(t,e,n)=>{"use strict";let i;n.d(e,{Z:()=>s});class s extends ConsoleModule{static get moduleName(){return"ws-module"}static get commandName(){return"ws"}static install(t){i=t}static uninstall(){}static _handleSocketMessage(t,e){const n=i.getTerminal(),s=JSON.parse(e.data);if("message"==s.type){const t=`${s.data.username}: ${s.data.text}`;n.append(n.cursor[1],t)}if("left"==s.type){const t=`${s.data.username} left the room.`;n.append(n.cursor[1],t)}}static async run(t){const e=t[0].split("@"),n=(e[0],e[1]);if(""==n||!n)return void i.print("Missing address to connect to.");const o=i.getTerminal();return o.setPrefix(""),o.disableInput(),i.print(`Connecting to ${t[0]}`),async function(t){return new Promise(((e,n)=>{const i=new WebSocket(t,"terminal-protocol");i.onopen=t=>{e(i)},i.onerror=t=>{n(t)}}))}(`wss:${n}`).then((async e=>{for(s.prefix=t[0]+":$ ",e.onmessage=t=>{this._handleSocketMessage(e,t)},i.print("Connected."),i.print("");;){const t=await o.read(s.prefix);if(""!=t&&(e.send(JSON.stringify({type:"input",data:{input:t}})),"^c"==t.toLocaleLowerCase()))return 1}})).catch((e=>{console.error(e),i.print(`Error connecting to ${t[0]}`)}))}}s.prefix="> "}},__webpack_module_cache__={};function __webpack_require__(t){if(__webpack_module_cache__[t])return __webpack_module_cache__[t].exports;var e=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.exports}__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var _Commands_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(548),_Console_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(258),_ConsoleModule_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(12),_modules_twitch_module_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(245),_modules_dl_module_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(285),_modules_ws_module_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(685);const PREROLL="\n\n@@@@@@            .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@ \n@@@@@@@@,               /@@@.                        @@@(            \n@@@@  @@@@#             /@@@.                        @@@(            \n@@@@    @@@@@@@@@       /@@@.     @@@@@@@@@@@&       @@@(            \n@@@@      @@@@@         /@@@.                        @@@(            \n(@@@        %           /@@@.                        @@@(            \n  .@                    /@@@.     @@@@@@@@@@@@@      @@@@@@@@@@@@@@@/\n\n",INPUT_PREFIX="terminal@52.59.209.57:~$ ",nativeModules=[_modules_ws_module_js__WEBPACK_IMPORTED_MODULE_5__.Z,_modules_twitch_module_js__WEBPACK_IMPORTED_MODULE_3__.Z,_modules_dl_module_js__WEBPACK_IMPORTED_MODULE_4__.Z];let idle=!0;const terminal=_Console_js__WEBPACK_IMPORTED_MODULE_1__.Z.getTerminal();terminal.disableInput(),mainEle.appendChild(terminal),setTimeout((async()=>{const terminal=_Console_js__WEBPACK_IMPORTED_MODULE_1__.Z.getTerminal();await _Console_js__WEBPACK_IMPORTED_MODULE_1__.Z.print(PREROLL),await _Console_js__WEBPACK_IMPORTED_MODULE_1__.Z.simulateWrite("Initializing...\n\n",4),await _Console_js__WEBPACK_IMPORTED_MODULE_1__.Z.print("Loading native modules...\n");for(let t of nativeModules){let e=t;"string"==typeof e&&(e=await _Console_js__WEBPACK_IMPORTED_MODULE_1__.Z.fetchModule(t).catch((t=>{_Console_js__WEBPACK_IMPORTED_MODULE_1__.Z.print("[Error] "+t.message)}))),await _Console_js__WEBPACK_IMPORTED_MODULE_1__.Z.installModule(e)}async function handleInput(args){function evaluate(){const result=eval(args.join(" "));result&&_Console_js__WEBPACK_IMPORTED_MODULE_1__.Z.print(result.toString())}if(""!=args[0])if(_Commands_js__WEBPACK_IMPORTED_MODULE_0__.Z[args[0]]){idle=!1;const t=await _Commands_js__WEBPACK_IMPORTED_MODULE_0__.Z[args[0]](args.slice(1));0!==t&&null!=t&&_Console_js__WEBPACK_IMPORTED_MODULE_1__.Z.print("\nProcess exited.\n"),terminal.read(INPUT_PREFIX),idle=!0}else try{evaluate.call(_Console_js__WEBPACK_IMPORTED_MODULE_1__.Z)}catch(t){console.error(t),_Console_js__WEBPACK_IMPORTED_MODULE_1__.Z.print("\n[Error] "+t.message)}}for(_Console_js__WEBPACK_IMPORTED_MODULE_1__.Z.print(""),await _Console_js__WEBPACK_IMPORTED_MODULE_1__.Z.print("Loading optional modules...\n"),await _Console_js__WEBPACK_IMPORTED_MODULE_1__.Z.loadModules(),_Console_js__WEBPACK_IMPORTED_MODULE_1__.Z.print(""),terminal.addEventListener("shortcut",(t=>{"r"==t.key?location.reload():"v"==t.key&&(navigator.clipboard.readText().then((t=>{terminal.write(t)})),t.defaultPrevented=!0)}));;){const t=await terminal.read(INPUT_PREFIX),e=t.split(" ");await handleInput(e).catch((t=>{console.error(t),_Console_js__WEBPACK_IMPORTED_MODULE_1__.Z.print(`\n[Internal Error]: ${t.message}\n`)}))}}),200)})()})();