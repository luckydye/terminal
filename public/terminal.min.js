(()=>{var __webpack_modules__={548:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var i=n(265);const s={modules(){for(let[t,e]of i.Z.getModules())i.Z.print(t)},async install([t]){if(t){const e=await i.Z.fetchModule(t).catch((t=>{i.Z.print("[Error] "+t.message)}));await i.Z.installModule(e)}else i.Z.print("Provide a module path.")},async uninstall([t]){t&&""!=t?await i.Z.uninstallModule(t):i.Z.print("Provide a module name.")},clear(t){i.Z.getTerminal().clear()},help(){i.Z.print(`\nCommands: \n${Object.keys(this).join(", ")}\n`)},exit:t=>new Promise((t=>{const e=i.Z.getTerminal();e.setPrefix(""),e.disableInput(),e.clear(),i.Z.print("Bye."),setTimeout((()=>window.close()),1e3)}))}},265:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>Console});var _Commands_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(548),_Terminal_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(890);const terminal=new _Terminal_js__WEBPACK_IMPORTED_MODULE_1__.Z;let ws,modules=new Map;const MODULE_REGISTRY_ID="modules";function getModuleRegistry(){let t=localStorage.getItem(MODULE_REGISTRY_ID);return t||(t='{ "modules": [] }'),JSON.parse(t)}function saveModuleRegistry(t){localStorage.setItem(MODULE_REGISTRY_ID,JSON.stringify(t))}let idle=!0;class Console{static get INPUT_PREFIX(){return"terminal@web:~$ "}static async loadModules(){const t=getModuleRegistry();for(let e of t.modules){const t=await Console.fetchModule(e).catch((t=>{Console.print("[Module Error] Module: '"+e+"': "+t.message)}));Console.installModule(t)}}static async evaluateInput(args){function evaluate(){const result=eval(args.join(" "));result&&Console.print(result.toString())}if(""!=args[0])if(_Commands_js__WEBPACK_IMPORTED_MODULE_0__.Z[args[0]]){let t;idle=!1,document.title=args[0];try{t=await _Commands_js__WEBPACK_IMPORTED_MODULE_0__.Z[args[0]](args.slice(1))}catch(t){throw document.title="Terminal",new Error(e)}document.title="Terminal",0!==t&&null!=t&&Console.print("\nProcess exited.\n"),terminal.read(this.INPUT_PREFIX),idle=!0}else try{evaluate.call(Console)}catch(t){console.error(t),Console.print("\n[Error] "+t.message)}}static getModules(){return modules}static async fetchModule(t){const e=await fetch(t).then((t=>t.text())),n="data:application/javascript;base64,"+btoa(e),i=await fetchModule(n);i.origin=t;let s=getModuleRegistry();return-1===s.modules.indexOf(i.origin)&&s.modules.push(i.origin),saveModuleRegistry(s),i}static async installModule(t){const e=t.moduleName||t.origin;if(modules.get(e))Console.print(`[Module] Module '${e}' already installed.`);else try{if(!t.install)throw new Error(`Missing install method in module: ${e}`);modules.set(e,t),await t.install(Console),Console.print(`[Module] Installed module '${e}'`),t.commandName&&(_Commands_js__WEBPACK_IMPORTED_MODULE_0__.Z[t.commandName]=t.run)}catch(t){Console.print("[Error] "+t.message)}}static uninstallModule(t){const e=modules.get(t);if(e){modules.delete(t),e.uninstall(),e.commandName&&(_Commands_js__WEBPACK_IMPORTED_MODULE_0__.Z[e.commandName]=null);let n=getModuleRegistry();n.modules.splice(n.modules.indexOf(e.origin),1),saveModuleRegistry(n),Console.print(`[Module] Uninstalled module '${t}'`)}else Console.print("Module not found.")}static getTerminal(){return terminal}static async simulateWrite(t,e=24){return new Promise((n=>{terminal.disableInput();let i=0;const s=setInterval((()=>{const e=t[i];terminal.write(e),i++,i==t.length&&(clearInterval(s),n())}),e)}))}static print(t){"object"==typeof t&&(t=JSON.stringify(t,null,"\t"));const e=t.split("\n");for(let t of e)terminal.write(t),terminal.write("\n")}static sleep(t){return new Promise((e=>{setTimeout((()=>e()),t)}))}}},890:(t,e,n)=>{"use strict";n.d(e,{Z:()=>x});const i=[32,32],s=[1,0],o="#eee",a=" ~{}@=<>^abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ()[]-.,_:;#+'*/&%$§!?€1234567890\"";let r,l,c=!0,u=7.69,d=["Terminal Version 1.0","(c) 2020 luckydye. All rights reserved.",""],h=[],p=[d[d.length-1].length,d.length-1],m=[0,0],_=[[0,0],[0,0]],f="",w=!0,g=!1,y=localStorage.history?JSON.parse(localStorage.history):[],v=-1;class b extends Event{constructor(t){super("submit"),this.value=t}}class M extends Event{get defaultPrevented(){return this._defaultPrevented}set defaultPrevented(t){this._defaultPrevented=t}constructor(t){super("shortcut"),this.key=t,this._defaultPrevented=!1}}class x extends HTMLElement{get hideOutput(){return g}set hideOutput(t){g=t}get inputEnabled(){return w}set inputEnabled(t){w=t}get prefix(){return f}set prefix(t){f=t}get cursor(){return p}constructor(){super(),r=document.createElement("canvas"),r.tabIndex=0,l=r.getContext("2d"),window.addEventListener("resize",(t=>{this.reformat()})),window.addEventListener("wheel",(t=>{const e=Math.sign(t.deltaY),n=this.getCursorPosition()[1],i=Math.max(0,n-(r.height-3*this.lineHeight));m[1]=Math.max(0,Math.min(i,m[1]+e*this.lineHeight))})),window.addEventListener("keydown",(t=>{this.handleInput(t)}));let t=[0,0];const e=(t,e,n)=>{const i=this.pixelToBufferPos(e+m[0],n+m[1]);_[t][0]=i[0],_[t][1]=i[1]},n=n=>{let i=1;t[1]>n.clientY&&(i=0),e(i,n.clientX,n.clientY)};window.addEventListener("mousedown",(i=>{0===i.button&&(t[0]=i.clientX,t[1]=i.clientY,e(0,i.clientX,i.clientY),e(1,i.clientX,i.clientY),window.addEventListener("mousemove",n))})),window.addEventListener("mouseup",(i=>{if(0===i.button){let s=1;t[1]>i.clientY&&(s=0),e(s,i.clientX,i.clientY),window.removeEventListener("mousemove",n)}})),this.addEventListener("contextmenu",(t=>{const e=this.getSelectionFromBuffer(_);navigator.clipboard.writeText(e),this.resetSelection(),t.preventDefault()})),this.attachShadow({mode:"open"})}resetSelection(){_=[[0,0],[0,0]]}getSelectionFromBuffer(t){let e=[];const n=t[0][1],i=t[1][1]-t[0][1],s=t[0],o=t[1];for(let t=0;t<=i;t++){let a=t>0&&i>0?0:s[0],r=t===i?o[0]:void 0;const l=d[n+t].slice(a,r);e.push(l)}return e.join("\n")}pixelToBufferPos(t,e){return[Math.floor((t-i[0])/u),Math.floor((e-i[1])/this.lineHeight)]}getContext(){return l}init(){const t=document.createElement("style");t.innerHTML="\n            :host {\n                width: 100%;\n                height: 100%;\n            }\n            :host(:focus) {\n                z-index: 1000000;\n                opacity: 1;\n                pointer-events: all;\n            }\n            canvas {\n                filter: contrast(1.1) blur(.33px);\n                outline: none;\n            }\n        ",this.shadowRoot.appendChild(t),this.shadowRoot.appendChild(r),this.tabIndex=0,this.loop()}connectedCallback(){r.parentNode||this.init(),this.reformat()}append(t,e){const n=d.slice(0,t);n.push(e),n.push(...d.slice(t)),p[1]>=t&&p[1]++,this.setBuffer(n)}setBuffer(t){d=t}clear(){d=[""],this.setCursor(0,0)}setCursor(t,e){p[0]=null!=t?t:p[0],p[1]=null!=e?e:p[1]}setPrefix(t=""){this.prefix=t}disableInput(){this.inputEnabled=!1}enableInput(){this.inputEnabled=!0}disableLineWrapping(){c=!1}enableLineWrapping(){c=!0}handleSubmit(t){g?(t=h.join(""),g=!1):t=t.slice(this.prefix.length),this.pushToHistory(t),this.dispatchEvent(new b(t))}pushToHistory(t){t!=y[0]&&(""!=t&&y.unshift(t),v=-1,localStorage.history=JSON.stringify(y))}cancelInput(){d[p[1]]=this.prefix,this.setCursor(d[p[1]].length)}replaceInput(t){this.cancelInput(),this.write(t)}read(t){return new Promise((e=>{const n=d[d.length-1];this.inputEnabled=!0,this.prefix=t||n,t&&n!==t&&this.write(t);const i=t=>{e(t.value),this.removeEventListener("submit",i)};this.addEventListener("submit",i)}))}newline(){const t=d[d.length-1];return d.push(""),p[0]="".length,p[1]++,t}write(t){switch(t){case"\0":break;case"\r":const e=this.newline();this.handleSubmit(e);break;case"\n":this.newline();break;default:const n=d[p[1]].split("").slice(0,p[0]);g?(h.push(t),n.push(...new Array(t.length).fill("*"))):n.push(t);const i=d[p[1]].split("").slice(p[0]);n.push(...i),d[p[1]]=n.join(""),p[0]+=t.length}const e=this.getCursorPosition()[1];m[1]=Math.max(0,e-(r.height-3*this.lineHeight))}handleInput(t){let e=t.key;t.shiftKey;const n=t.ctrlKey;if(w){if("Enter"==e&&this.write("\r"),"ArrowUp"==e&&(v=Math.min(v+1,y.length-1),y[v]&&this.replaceInput(y[v])),"ArrowDown"==e&&(v=Math.max(v-1,0),y[v]&&this.replaceInput(y[v])),"ArrowLeft"==e&&(p[0]=Math.max(p[0]-1,Math.max(f.length,0))),"ArrowRight"==e&&(p[0]=Math.min(p[0]+1,d[d.length-1].length)),"Escape"==e&&this.cancelInput(),"End"==e&&(p[0]=d[d.length-1].length),"Home"==e&&(p[0]=Math.max(f.length,0)),"Backspace"==e&&p[0]>0&&p[0]>f.length){const t=d[d.length-1].split("").slice(0,p[0]-1),e=d[d.length-1].split("").slice(p[0]);t.push(...e),d[d.length-1]=t.join(""),p[0]--}if("Delete"==e){const t=d[d.length-1].split("").slice(0,p[0]),e=d[d.length-1].split("").slice(p[0]+1);t.push(...e),d[d.length-1]=t.join("")}-1==a.indexOf(e)||n||this.write(e)}if(n){const n=new M(e);this.dispatchEvent(n),t.preventDefault(),t.stopPropagation(),n.defaultPrevented||-1!=a.indexOf(e)&&this.dispatchEvent(new b("^"+e))}}reformat(){r.width=this.clientWidth,r.height=this.clientHeight;const t=this.getCursorPosition()[1];m[1]=Math.max(0,t-(r.height-3*this.lineHeight))}draw(t){if(t.clearRect(0,0,t.canvas.width,t.canvas.height),r.width<=0)return;t.font="200 13px monospace",t.textAlign="left",t.textBaseline="top";const e=t.measureText("M");u=e.width,t.shadowColor=o,t.shadowBlur=0,t.fillStyle=o,this.drawBuffer(),this.inputEnabled&&this.drawCursor(),this.drawSelection(),t.shadowColor="none",t.shadowBlur=0}drawCursor(){if(Date.now()/500%2>1){const t=this.getCursorPosition();l.fillStyle=o,l.fillRect(t[0],t[1]-m[1],6,16)}}bufferToPixelPos(t,e){return[t*u+i[0]-m[0],e*this.lineHeight+i[1]-m[1]]}drawSelection(){const t=this.bufferToPixelPos(..._[0]),e=this.bufferToPixelPos(..._[1]);l.globalCompositeOperation="screen",l.shadowColor="",l.shadowBlur=0;const n=_[1][1]-_[0][1];for(let i=0;i<=n;i++){let s=0;const o=t[1]+this.lineHeight*i;let a=u;const c=e[0]-t[0];a=n===i?c+t[0]:r.width,0===i&&(s=t[0],n===i&&(a=c)),l.fillStyle="#717171",l.fillRect(s,o,a,this.lineHeight)}l.globalCompositeOperation=""}getMaxBufferWidth(){return r.width-2*i[0]}get lineHeight(){return 15}getCursorPosition(){const t=this.getMaxBufferWidth();let e=0;for(let n=0;n<p[1];n++){const i=d[n];if(t-l.measureText(i).width<0&&c){const n=C(i,t/u);for(let t of n)e++}else e++}return[i[0]+p[0]*u+s[0],i[1]+12*e+3*e+6-8+s[1]]}drawBuffer(){const t=this.getMaxBufferWidth();let e=i[0],n=i[1]-m[1];const s=t=>{l.fillText(t,e,n),n+=15};for(let e of d)if(t-l.measureText(e).width<0&&c){const n=C(e,t/u);for(let t of n)s(t)}else s(e)}loop(){this.draw(l),requestAnimationFrame(this.loop.bind(this))}}function C(t,e){const n=[];for(t=t.split("");t.length>e;){const i=t.splice(0,e);n.push(i.join(""))}return n.push(t.join("")),n}customElements.define("gyro-terminal",x)},591:t=>{const e=localStorage.twitch_client_id,n=localStorage.twitch_client_secret;let i,s=null;function o(){return i.print("authorizing..."),fetch(`https://id.twitch.tv/oauth2/token?client_id=${e}&client_secret=${n}&grant_type=client_credentials&scope=`,{method:"POST"}).then((t=>t.json())).then((t=>s=t))}async function a(t,n={}){const i=Object.assign({headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.access_token}`,"Client-ID":e}},n);return await fetch(t,i).then((t=>t.json()))}async function r(t){return s||await o(),a(`https://api.twitch.tv/helix/users?login=${t}`).then((t=>{if(0==t.data.length)throw new Error("User not found");return t}))}async function l(t){const e=(await r(t)).data[0],n=[];return i.print(`Fethcing ${t} followers,`),await async function t(s){const o=await async function(t){let n=`https://api.twitch.tv/helix/users/follows?to_id=${e.id}&first=100`;return t&&(n+=`&after=${t}`),await a(n)}(s);i.print(`${n.length} / ${o.total}`),n.push(...o.data),o.pagination.cursor&&await t(o.pagination.cursor)}(),n}t.exports={setConsole:function(t){i=t},getUserByLogin:r,getUserFollowers:async function(t){const e=(await r(t)).data[0],n=[];await async function t(i){const s=await async function(t){let n=`https://api.twitch.tv/helix/users/follows?from_id=${e.id}&first=100`;return t&&(n+=`&after=${t}`),await a(n)}(i);n.push(...s.data),s.pagination.cursor&&await t(s.pagination.cursor)}(),i.print(`${e.display_name} is following (${n.length}):`);for(let t of n)i.print(`${t.followed_at}, ${t.to_name}`)},getChannelViewerOverlap:async function(t,e){i.print(`Getting channel follower overlap of ${t} and ${e}`);const n=await l(t),s=await l(e),o={};let a=0;for(let t of n)o[t.from_id]=0;for(let t of s)null!=o[t.from_id]&&(a++,o[t.from_id]=1),o[t.from_id]=0;return i.print(`${a} of ${t}(${n.length}) [${(a/n.length*100).toFixed(3)}%] are also in ${e}`),a/n.length*100},getStreamsByUser:async function(t){return s||await o(),a(`https://api.twitch.tv/helix/streams?user_login=${t}`).then((async t=>t.data[0]))},queryClipsByStreamId:async function(t){let e=0;for(;e<5910;){e++;const n=`https://clips-media-assets2.twitch.tv/${t}-offset-${e}.mp4`;await fetch(n).then((t=>{i.print(n,t.status)}))}return t},getVODsByUser:async function(t){return s||await o(),a(`https://api.twitch.tv/helix/videos?user_id=${(await r(t)).data[0].id}&type=archive&first=100`).then((async t=>t.data))},getChannelAllFollowers:async function(t){i.print("Getting channel followers...");const e=await l(t);for(let t of e)i.print(`${t.followed_at}, ${t.from_name}`)}}}},__webpack_module_cache__={};function __webpack_require__(t){if(__webpack_module_cache__[t])return __webpack_module_cache__[t].exports;var e=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.exports}__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";window.ConsoleModule=class{static get moduleName(){return"console-module"}static get commandName(){return""}static install(){}static uninstall(){}static run(t){}};var t=__webpack_require__(265);const e=[];class n{static get modules(){return[{moduleName:"ls",commandName:"ls",install(){},run(n){t.Z.print("/");for(let n of e)t.Z.print(n)}}]}}let i;class s extends ConsoleModule{static get moduleName(){return"dl-module"}static get commandName(){return"dl"}static install(t){i=t}static async run(t){const e=t[0];if(!e)return i.print("Provide a video link.");const n=await async function(t){const e=new URL(t);let n=e.host;switch(console.log(n),n){case"clips.twitch.tv":const t={query:`{\n                    clip(slug: "${e.pathname.split("/")[1]}") {\n                        broadcaster {\n                            displayName\n                        }\n                        createdAt\n                        curator {\n                            displayName\n                            id\n                        }\n                        durationSeconds\n                        id\n                        tiny: thumbnailURL(width: 86, height: 45)\n                        small: thumbnailURL(width: 260, height: 147)\n                        medium: thumbnailURL(width: 480, height: 272)\n                        title\n                        videoQualities {\n                            frameRate\n                            quality\n                            sourceURL\n                        }\n                        viewCount\n                    }\n                }`};return fetch("https://gql.twitch.tv/gql",{method:"POST",headers:{"Client-ID":"kimne78kx3ncx6brgo4mv6wki5h1ko"},body:JSON.stringify(t)}).then((t=>t.json())).then((t=>{const e=t.data.clip;return{service:n,source:e.videoQualities[0].sourceURL}}))}return null}(e);n?(function(t){if(t){const e=document.createElement("a");e.href=t,e.download=t,e.click()}}(n.source),i.print(n)):i.print("Not a valid video url.")}}var o=__webpack_require__(591);const a={streamClips:async t=>t[0]?await(0,o.queryClipsByStreamId)(t[0]):"Provide twitch login name.",vod:async t=>t[0]?await(0,o.getVODsByUser)(t[0]):"Provide twitch login name.",stream:async t=>t[0]?await(0,o.getStreamsByUser)(t[0]):"Provide twitch login name.",user:async t=>t[0]?(await(0,o.getUserByLogin)(t[0])).data[0]:"Provide twitch login name.",following(t){if(!t[0])return"Provide twitch login name!";(0,o.getUserFollowers)(t[0])},followers(t){if(!t[0])return"Provide twitch login name!";(0,o.getChannelAllFollowers)(t[0])},viewership(t){if(!t[0]||!t[1])return"Provide twitch login name!";(0,o.getChannelViewerOverlap)(t[0],t[1])}};let r,l;class c extends ConsoleModule{static get moduleName(){return"twitch-module"}static get commandName(){return"twitch"}static install(t){r=t}static async run(t){(0,o.setConsole)(r);const e=t[0],n=t.slice(1);if(e in a){const t=await a[e](n);t&&r.print(t)}else r.print("Unknown command"),r.print(`Commands: ${Object.keys(a)}`)}}class u extends ConsoleModule{static get moduleName(){return"ws-module"}static get commandName(){return"ws"}static install(t){l=t}static uninstall(){}static _handleSocketMessage(t,e){const n=l.getTerminal(),i=JSON.parse(e.data);if("message"==i.type){const t=`${i.data.username}: ${i.data.text}`;n.append(n.cursor[1],t)}if("left"==i.type){const t=`${i.data.username} left the room.`;n.append(n.cursor[1],t)}}static async run(t){const e=t[0].split("@"),n=(e[0],e[1]);if(""==n||!n)return void l.print("Missing address to connect to.");const i=l.getTerminal();return i.setPrefix(""),i.disableInput(),l.print(`Connecting to ${t[0]}`),async function(t){return new Promise(((e,n)=>{const i=new WebSocket(t,"terminal-protocol");i.onopen=t=>{e(i)},i.onerror=t=>{n(t)}}))}(`wss:${n}`).then((async e=>{for(u.prefix=t[0]+":$ ",e.onmessage=t=>{this._handleSocketMessage(e,t)},l.print("Connected."),l.print("");;){const t=await i.read(u.prefix);if(""!=t&&(e.send(JSON.stringify({type:"input",data:{input:t}})),"^c"==t.toLocaleLowerCase()))return 1}})).catch((e=>{console.error(e),l.print(`Error connecting to ${t[0]}`)}))}}u.prefix="> ";const d={moduleName:"title",commandName:"title",install(){},run(t){const e=t.join(" ");document.title=e}};window.initialiseTerminal=()=>{!function(){const e=[u,c,s,d,...n.modules],i=t.Z.getTerminal();i.disableInput(),document.body.appendChild(i),setTimeout((async()=>{const n=t.Z.getTerminal();await t.Z.print("\n\n@@@@@@            .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@ \n@@@@@@@@,               /@@@.                        @@@(            \n@@@@  @@@@#             /@@@.                        @@@(            \n@@@@    @@@@@@@@@       /@@@.     @@@@@@@@@@@&       @@@(            \n@@@@      @@@@@         /@@@.                        @@@(            \n(@@@        %           /@@@.                        @@@(            \n  .@                    /@@@.     @@@@@@@@@@@@@      @@@@@@@@@@@@@@@/\n\n    "),await t.Z.simulateWrite("Initializing...\n\n",4),await t.Z.print("Loading native modules...\n");for(let n of e){let e=n;"string"==typeof e&&(e=await t.Z.fetchModule(n).catch((e=>{t.Z.print("[Error] "+e.message)}))),await t.Z.installModule(e)}for(t.Z.print(""),await t.Z.print("Loading optional modules...\n"),await t.Z.loadModules(),t.Z.print(""),n.addEventListener("shortcut",(t=>{"r"==t.key?location.reload():"v"==t.key&&(navigator.clipboard.readText().then((t=>{n.write(t)})),t.defaultPrevented=!0)}));;){const e=(await n.read(t.Z.INPUT_PREFIX)).split(" ");await t.Z.evaluateInput(e).catch((e=>{console.error(e),t.Z.print(`\n[Internal Error]: ${e.message}\n`)}))}}),200)}()}})()})();